import{K as V,L as v,N as P,O as Q,i as en,P as rn,Q as Z,R as q,S as on,T as sn,U as cn,V as fn,W as un,E as an,X as ln,Y as G,Z as mn,_,$ as B,a0 as C,a1 as X,a2 as F,a3 as E,a4 as gn,a5 as hn,a6 as yn,a7 as wn,a8 as K}from"./DMkSVGaj.js";function pn(n,t){var r=0;return Float64Array.from(n,e=>r+=+e||0)}function S(n,t,r){return(t.length!==2?V(P(n,t,r),([e,o],[s,f])=>v(o,f)||v(e,s)):V(Q(n,r),([e,o],[s,f])=>t(o,f)||v(e,s))).map(([e])=>e)}function H(n,t=v){let r,e=!1;if(t.length===1){let o;for(const s of n){const f=t(s);(e?v(f,o)>0:v(f,f)===0)&&(r=s,o=f,e=!0)}}else for(const o of n)(e?t(o,r)>0:t(o,o)===0)&&(r=o,e=!0);return r}function Un(n={},t="y"){return rn(n)?n:{...n,[t]:en}}function vn(n,t){if(t.length===1)return{data:n,facets:t};const r=Z(n),e=new Uint8Array(r);let o=0;for(const c of t)for(const u of c)e[u]&&++o,e[u]=1;if(o===0)return{data:n,facets:t};n=q(n);const s=n[on]=new Uint32Array(r+o);t=t.map(c=>q(c,Uint32Array));let f=r;e.fill(0);for(const c of t)for(let u=0,a=c.length;u<a;++u){const l=c[u];e[l]?(c[u]=f,n[f]=n[l],s[f]=l,++f):s[l]=l,e[l]=1}return{data:n,facets:t}}function xn(n={},t={}){arguments.length===1&&([n,t]=An(n));const{x1:r,x:e=r,y:o,...s}=t,[f,c,u,a]=kn(e,o,"x","y",n,s);return{...f,x1:r,x:c,y1:u,y2:a,y:un(u,a)}}function jn({y:n,y1:t,y2:r,...e}={}){return e=sn(e,"x"),t===void 0&&r===void 0?xn({y:n,...e}):([t,r]=cn(n,t,r),{...e,y1:t,y2:r})}function An(n){const{offset:t,order:r,reverse:e,...o}=n;return[{offset:t,order:r,reverse:e},o]}const bn={length:!0};function kn(n,t=fn,r,e,{offset:o,order:s,reverse:f},c){if(t===null)throw new Error(`stack requires ${e}`);const u=an(c),[a,l]=ln(n),[i,h]=G(t),[m,y]=G(t);return i.hint=m.hint=bn,o=Xn(o),s=En(s,o,e),[mn(c,(g,x,$)=>{({data:g,facets:x}=vn(g,x));const z=n==null?void 0:l(hn(X(g,n),$==null?void 0:$[r])),U=X(g,t,Float64Array),j=X(g,u),L=s&&s(g,z,U,j),W=Z(g),A=h(new Float64Array(W)),b=y(new Float64Array(W)),M=[];for(const R of x){const D=z?Array.from(Q(R,p=>z[p]).values()):[R];if(L)for(const p of D)p.sort(L);for(const p of D){let T=0,I=0;f&&p.reverse();for(const w of p){const k=U[w];k<0?T=b[w]=(A[w]=T)+k:k>0?I=b[w]=(A[w]=I)+k:b[w]=A[w]=I}}M.push(D)}return o&&o(M,A,b,j),{data:g,facets:x}}),a,i,m]}function Xn(n){if(n!=null){if(typeof n=="function")return n;switch(`${n}`.toLowerCase()){case"expand":case"normalize":return Cn;case"center":case"silhouette":return Fn;case"wiggle":return Y}throw new Error(`unknown offset: ${n}`)}}function J(n,t){let r=0,e=0;for(const o of n){const s=t[o];s<r&&(r=s),s>e&&(e=s)}return[r,e]}function Cn(n,t,r){for(const e of n)for(const o of e){const[s,f]=J(o,r);for(const c of o){const u=1/(f-s||1);t[c]=u*(t[c]-s),r[c]=u*(r[c]-s)}}}function Fn(n,t,r){for(const e of n){for(const o of e){const[s,f]=J(o,r);for(const c of o){const u=(f+s)/2;t[c]-=u,r[c]-=u}}nn(e,t,r)}tn(n,t,r)}function Y(n,t,r,e){for(const o of n){const s=new B;let f=0;for(const c of o){let u=-1;const a=c.map(m=>Math.abs(r[m]-t[m])),l=c.map(m=>{u=e?e[m]:++u;const y=r[m]-t[m],g=s.has(u)?y-s.get(u):0;return s.set(u,y),g}),i=[0,...pn(l)];for(const m of c)t[m]+=f,r[m]+=f;const h=C(a);h&&(f-=C(a,(m,y)=>(l[y]/2+i[y])*m)/h)}nn(o,t,r)}tn(n,t,r)}function nn(n,t,r){const e=E(n,o=>E(o,s=>t[s]));for(const o of n)for(const s of o)t[s]-=e,r[s]-=e}function tn(n,t,r){const e=n.length;if(e===1)return;const o=n.map(c=>c.flat()),s=o.map(c=>(E(c,u=>t[u])+gn(c,u=>r[u]))/2),f=E(s);for(let c=0;c<e;c++){const u=f-s[c];for(const a of o[c])t[a]+=u,r[a]+=u}}function En(n,t,r){if(n===void 0&&t===Y)return N(F);if(n!=null){if(typeof n=="string"){const e=n.startsWith("-"),o=e?yn:F;switch((e?n.slice(1):n).toLowerCase()){case"value":case r:return dn(o);case"z":return $n(o);case"sum":return zn(o);case"appearance":return Dn(o);case"inside-out":return N(o)}return O(wn(n))}if(typeof n=="function")return(n.length===1?O:In)(n);if(_(n))return Kn(n);throw new Error(`invalid order: ${n}`)}}function dn(n){return(t,r,e)=>(o,s)=>n(e[o],e[s])}function $n(n){return(t,r,e,o)=>(s,f)=>n(o[s],o[f])}function zn(n){return d(n,(t,r,e,o)=>S(K(t),s=>C(s,f=>e[f]),s=>o[s]))}function Dn(n){return d(n,(t,r,e,o)=>S(K(t),s=>r[H(s,f=>e[f])],s=>o[s]))}function N(n){return d(n,(t,r,e,o)=>{const s=K(t),f=S(s,i=>r[H(i,h=>e[h])],i=>o[i]),c=P(s,i=>C(i,h=>e[h]),i=>o[i]),u=[],a=[];let l=0;for(const i of f)l<0?(l+=c.get(i),u.push(i)):(l-=c.get(i),a.push(i));return a.reverse().concat(u)})}function O(n){return t=>{const r=X(t,n);return(e,o)=>F(r[e],r[o])}}function In(n){return t=>_(t)?(r,e)=>n(t[r],t[e]):(r,e)=>n(t.get(r),t.get(e))}function Kn(n){return d(F,()=>n)}function d(n,t){return(r,e,o,s)=>{if(!s)throw new Error("missing channel: z");const f=new B(t(r,e,o,s).map((c,u)=>[c,u]));return(c,u)=>n(f.get(s[c]),f.get(s[u]))}}export{Un as a,jn as m};
