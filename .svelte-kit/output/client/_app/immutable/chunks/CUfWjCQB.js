import"./CWj6FrbW.js";import"./Dh1LkfYh.js";import{p as At,y as re,i as e,q as k,o as b,j as H,z as Vt,f as _,c as r,r as a,a as c,m as Wt,A as et,x as he,s as o,t as S,e as m,v as tt,n as Yt,B as De,C as at,D as st,E as rt,w as ot}from"./CGZSrXyu.js";import{s as D,e as I}from"./BzHdtkot.js";import{i as B,b as qt}from"./JwmFF-xm.js";import{C as A,d as Qt,f as Ut,h as Ht,e as X,i as G,r as it,j as It,a as Xt,b as lt,s as Gt}from"./BM8ST8i7.js";import{m as nt,a as vt,l as bt,h as Kt}from"./DeawExuB.js";import{l as dt,s as fe}from"./BCAIgc4A.js";import{s as ct}from"./BR0iTFIE.js";import{i as Jt}from"./ui6rPYHM.js";import{p as we}from"./BWiVFVQA.js";import{z as Pe,A as ut,B as pt,C as Fe,D as mt}from"./CKo-VmNz.js";import{b as Ce}from"./ChBfiQIT.js";import{d as _t}from"./CH6E2OhH.js";const L=10;function Zt(h){return[{label:"Site-level dN/dS estimates",available:i=>!!i["confidence interval"]},{label:"alpha/beta site-level estimates",available:()=>!0},{label:"Bootstrap vs asymptotic p-value",available:()=>h},{label:"Rate density plots",available:()=>!0},{label:"Q-Q plots",available:()=>h},{label:"Dense rate plot",available:()=>!0}]}function ea(h,i){return{"Site-level dN/dS estimates":"Maximum likelihood estimates of dN/dS at each site, together with estimated profile confidence intervals (if available). dN/dS = 1 (neutrality) is depicted as a horizontal gray line. Boundaries between partitions (if present) are shown as vertical dashed lines.","alpha/beta site-level estimates":`Maximum likelihood estimates of synonymous (α) and non-synonymous rates (β) at each site shown as bars. The line shows the estimates under the null model (α=β). Estimates above ${L} are censored at this value.`,"Dense rate plot":`Maximum likelihood estimates of synonymous (α) and non-synonymous rates (β) at each site. Estimates above ${L} are censored at this value. p-values are also shown`,"Bootstrap vs asymptotic p-value":`Comparison of site-level p-values for non-neutrality using parametric bootstrap and the asymptotic approximation. Rejection region (p ≤ ${i}) is shown as a shaded rectangle`,"Rate density plots":`Kernel density estimates of site-level rate estimates. Means are shown with red rules. Estimates above ${L} are censored at this value.`,"Q-Q plots":"Comparison of asymptotic vs bootstrap LRT distributions (limited to 60 sites)."}[h]||""}function ta(h){var u;const i=h.map(t=>({...t,"dN/dS MLE":Math.min(t["dN/dS MLE"]||0,L),"dN/dS LB":Math.min(t["dN/dS LB"]||0,L),"dN/dS UB":Math.min(t["dN/dS UB"]||0,L)}));return Pe({width:800,height:400,marginBottom:40,x:{label:"Codon",tickFormat:t=>t.toString()},y:{label:"dN/dS",grid:!0,type:"sqrt"},color:{type:"categorical",domain:Object.keys(A),range:Object.values(A),legend:!0},marks:[mt([1],{stroke:"gray",strokeOpacity:.5,strokeWidth:2}),...((u=h[0])==null?void 0:u["dN/dS LB"])!==void 0?[bt(i,{x:"codon",y1:"dN/dS LB",y2:"dN/dS UB",stroke:"steelblue",strokeWidth:1})]:[],_t(i,{x:"codon",y:"dN/dS MLE",fill:"class",r:4,tip:!0})]})}function aa(h){const i=h.map(t=>({codon:t.codon,alpha:-Math.min(t.alpha,L),beta:Math.min(t.beta,L),neutral:Math.min(t["alpha=beta"],L),class:t.class,partition:t.partition})),u=Math.max(...i.map(t=>Math.max(Math.abs(t.alpha),t.beta)));return Pe({width:800,height:400,marginLeft:60,marginBottom:50,x:{label:"Codon",tickFormat:t=>t.toString()},y:{label:"Rate estimate",domain:[-u*1.1,u*1.1],grid:!0,tickFormat:t=>{const E=Math.abs(t);return t>0?`β = ${E.toFixed(1)}`:t<0?`α = ${E.toFixed(1)}`:"0"}},color:{type:"categorical",domain:Object.keys(A),range:Object.values(A)},marks:[mt([0],{stroke:"gray",strokeOpacity:.5,strokeWidth:1}),Fe(i,{x:t=>t.codon-.4,x2:t=>t.codon+.4,y:0,y2:"alpha",fill:"class",stroke:"white",strokeWidth:.5,fillOpacity:.8}),Fe(i,{x:t=>t.codon-.4,x2:t=>t.codon+.4,y:0,y2:"beta",fill:"class",stroke:"white",strokeWidth:.5,fillOpacity:.8}),bt(i,{x:t=>t.codon-.4,x2:t=>t.codon+.4,y:"neutral",y2:"neutral",stroke:"#333",strokeWidth:2,strokeOpacity:.8}),Fe(i,{x:t=>t.codon-.4,x2:t=>t.codon+.4,y:"alpha",y2:"beta",fill:"transparent",title:t=>`Codon ${t.codon}
α = ${Math.abs(t.alpha).toFixed(3)}
β = ${t.beta.toFixed(3)}
α=β = ${t.neutral.toFixed(3)}
Class: ${t.class}`})]})}function sa(h,i){const u=h.map(t=>({...t,agree:(t["p-value"]-i)*((t["p-asmp"]||0)-i)>=0?"Yes":"No"}));return Pe({width:500,height:500,x:{label:"Bootstrap p-value",type:"sqrt",grid:!0},y:{label:"Asymptotic p-value",type:"sqrt",grid:!0},color:{type:"categorical",domain:Object.keys(A),range:Object.values(A),legend:!0},marks:[Fe([{x1:0,y1:0,x2:i,y2:i}],{x1:"x1",y1:"y1",x2:"x2",y2:"y2",fill:"#DDD",fillOpacity:.3}),_t(u,{x:"p-value",y:"p-asmp",fill:"class",symbol:t=>t.agree==="Yes"?"circle":"cross",r:5,fillOpacity:.7,tip:!0})]})}function ra(h){const i=h.map(M=>Math.min(M.alpha,L)),u=h.map(M=>Math.min(M.beta,L)),t=nt(i),E=nt(u);return Pe({width:600,height:400,x:{label:"Rate value",grid:!0},y:{label:"Density",grid:!0},marks:[vt(i,Ce({y:"count"},{x:M=>M})),dt(i,Ce({y:"count"},{x:M=>M})),vt(u,Ce({y:"count"},{x:M=>M})),dt(u,Ce({y:"count"},{x:M=>M})),ut([t],{stroke:"steelblue",strokeWidth:2,strokeDasharray:"4,2"}),ut([E],{stroke:"orange",strokeWidth:2,strokeDasharray:"4,2"}),pt([{x:t,y:0,text:`α mean: ${t.toFixed(2)}`}],{x:"x",y:"y",text:"text",dy:-10,fill:"steelblue",fontSize:12}),pt([{x:E,y:0,text:`β mean: ${E.toFixed(2)}`}],{x:"x",y:"y",text:"text",dy:-25,fill:"orange",fontSize:12})]})}function oa(h,i,u){switch(h){case"Site-level dN/dS estimates":return ta(i);case"alpha/beta site-level estimates":return aa(i);case"Bootstrap vs asymptotic p-value":return sa(i,u);case"Rate density plots":return ra(i);default:return null}}var ia=_('<div class="loading svelte-1ud9e95"><p>Loading FEL data...</p></div>'),la=_('<div class="tile svelte-1ud9e95"><div class="tile-number svelte-1ud9e95"> </div> <div class="tile-description svelte-1ud9e95"> </div></div>'),na=_("<code> </code> site-level parametric bootstrap replicates",1),va=_('<label class="checkbox-label svelte-1ud9e95"><input type="checkbox"/> </label>'),da=_("<option> </option>"),ca=_('<div class="plot-section svelte-1ud9e95"><h3 class="svelte-1ud9e95">Figure 1</h3> <p class="plot-description svelte-1ud9e95"> </p> <div class="plot-container svelte-1ud9e95"></div></div>'),ua=_('<th><span class="header-content svelte-1ud9e95"> <span class="sort-indicator svelte-1ud9e95"><!></span></span></th>'),pa=_('<td class="svelte-1ud9e95"><!></td>'),ba=_("<tr></tr>"),ma=_("<button></button>"),_a=_('<span class="ellipsis svelte-1ud9e95">...</span>'),ha=_("<button> </button>"),fa=_('<span class="ellipsis svelte-1ud9e95">...</span>'),ya=_("<button>1</button> <!> <!> <!> <button> </button>",1),ga=_('<div class="pagination svelte-1ud9e95"><div class="pagination-info svelte-1ud9e95"> </div> <div class="pagination-controls svelte-1ud9e95"><button class="page-btn svelte-1ud9e95">Previous</button> <!> <button class="page-btn svelte-1ud9e95">Next</button></div> <div class="page-size-control svelte-1ud9e95"><label for="page-size" class="svelte-1ud9e95">Items per page:</label> <select id="page-size" class="svelte-1ud9e95"><option>25</option><option>50</option><option>100</option><option>200</option></select></div></div>'),xa=_('<div class="table-container svelte-1ud9e95"><table class="svelte-1ud9e95"><thead><tr></tr></thead><tbody></tbody></table> <!></div>'),ka=_("<p>No data to display with current filters.</p>"),Sa=_(`<div class="summary-tiles svelte-1ud9e95"></div> <div class="analysis-info svelte-1ud9e95"><p>Statistical significance is evaluated based on <!>.
        This analysis <strong> </strong> site to site synonymous rate variation. <!></p></div> <div class="controls svelte-1ud9e95"><div class="control-group svelte-1ud9e95"><label for="pvalue-threshold" class="svelte-1ud9e95">p-value threshold:</label> <input id="pvalue-threshold" type="number" step="0.01" min="0" max="1" class="svelte-1ud9e95"/></div> <div class="control-group svelte-1ud9e95"><label class="svelte-1ud9e95">Show classes:</label> <div class="checkbox-group svelte-1ud9e95"></div></div> <div class="control-group svelte-1ud9e95"><label for="plot-type" class="svelte-1ud9e95">Plot type:</label> <select id="plot-type" class="svelte-1ud9e95"></select></div></div> <!> <div class="table-section svelte-1ud9e95"><h3 class="svelte-1ud9e95">Table 1</h3> <p class="table-description svelte-1ud9e95">Detailed site-by-site results from the FEL analysis</p> <!></div> <div class="citation svelte-1ud9e95"><h3 class="svelte-1ud9e95">Suggested Citation</h3> <p><code class="svelte-1ud9e95"> </code></p></div>`,1),Ma=_('<div class="fel-visualization svelte-1ud9e95"><!></div>');function Aa(h,i){At(i,!1);const u=k(),t=k(),E=k(),M=[];let g=we(i,"data",8,null),K=we(i,"pvalueThreshold",12,.1),oe=we(i,"showColumns",28,()=>["Diversifying","Purifying","Neutral","Invariable"]),T=we(i,"plotType",12,"alpha/beta site-level estimates"),ie=k({}),F=k([[],[],{}]),x=k([]),Ve=k([]),We=k(""),le=k([]),V=k(),l=k(1),P=k(50),J=k("Site"),Z=k("asc");function ht(n){return A[n]||"#000000"}function ye(n){b(l,Math.max(1,Math.min(n,e(t))))}function ft(){e(l)<e(t)&&rt(l)}function yt(){e(l)>1&&rt(l,-1)}function gt(n){e(J)===n?b(Z,e(Z)==="asc"?"desc":"asc"):(b(J,n),b(Z,"asc")),b(l,1)}function Ye(){var y;if(!((y=g())!=null&&y.MLE))return;b(ie,Qt(g())),b(F,Ut(g(),K())),b(Ve,Ht(g(),K()));const n=Zt(e(ie).hasPasmt);b(le,n.filter(f=>f.available(g())).map(f=>f.label)),!e(le).includes(T())&&e(le).length>0&&T(e(le)[0]),b(x,e(F)[0].filter(f=>oe().includes(f.class))),Be()}function Be(){if(!(!g()||!T()||e(x).length===0||!e(V))){b(We,ea(T(),K())),et(V,e(V).innerHTML="");try{const n=oa(T(),e(x),K());n&&e(V).appendChild(n)}catch(n){console.error("Error creating plot:",n),et(V,e(V).innerHTML='<p class="error">Error rendering plot</p>')}}}function xt(n,y){if(typeof y=="function"){const f=y(n);return typeof f=="string"?f:String(f)}return String(n)}re(()=>(e(F),H(oe()),e(x)),()=>{if(e(F)[0].length>0&&oe()){const n=new Set(e(x).map(y=>y.codon));b(x,e(F)[0].filter(y=>oe().includes(y.class)&&(!e(x).length||n.has(y.codon)))),b(l,1),Be()}}),re(()=>(e(x),e(J),e(Z)),()=>{b(u,[...e(x)].sort((n,y)=>{const f=n[e(J)],W=y[e(J)];if(typeof f=="number"&&typeof W=="number")return e(Z)==="asc"?f-W:W-f;const ee=String(f).toLowerCase(),te=String(W).toLowerCase();return e(Z)==="asc"?ee<te?-1:ee>te?1:0:ee>te?-1:ee<te?1:0}))}),re(()=>(e(u),e(P)),()=>{b(t,Math.ceil(e(u).length/e(P)))}),re(()=>(e(u),e(l),e(P)),()=>{b(E,e(u).slice((e(l)-1)*e(P),e(l)*e(P)))}),re(()=>H(g()),()=>{g()&&Ye()}),re(()=>H(K()),()=>{K()!==void 0&&Ye()}),re(()=>(H(T()),e(x)),()=>{T()&&e(x).length>0&&Be()}),Vt(),Jt();var Le=Ma(),kt=r(Le);{var St=n=>{var y=ia();c(n,y)},Mt=n=>{var y=Sa(),f=he(y);X(f,5,()=>e(Ve),G,(v,s)=>{var d=la(),p=r(d),w=r(p,!0);a(p);var j=o(p,2),ue=r(j,!0);a(j),a(d),S(()=>{ct(d,`border-left: 4px solid var(--color-${e(s),m(()=>e(s).color)??""}, #ccc)`),D(w,(e(s),m(()=>e(s).number))),D(ue,(e(s),m(()=>e(s).description)))}),c(v,d)}),a(f);var W=o(f,2),ee=r(W),te=o(r(ee));{var Dt=v=>{var s=na(),d=he(s),p=r(d,!0);a(d),Yt(),S(()=>D(p,(H(g()),m(()=>g().simulated)))),c(v,s)},wt=v=>{var s=De("the asymptotic chi-squared distribution");c(v,s)};B(te,v=>{H(g()),m(()=>g().simulated)?v(Dt):v(wt,!1)})}var Ne=o(te,2),Ct=r(Ne,!0);a(Ne);var Ft=o(Ne,2);{var Pt=v=>{var s=De("Profile approximate confidence intervals for site-level dN/dS ratios have been computed.");c(v,s)};B(Ft,v=>{e(ie),m(()=>e(ie).hasCi)&&v(Pt)})}a(ee),a(W);var Oe=o(W,2),$e=r(Oe),qe=o(r($e),2);it(qe),a($e);var Ee=o($e,2),Qe=o(r(Ee),2);X(Qe,5,()=>(H(A),m(()=>Object.keys(A))),G,(v,s)=>{var d=va(),p=r(d);it(p);var w,j=o(p);a(d),S(ue=>{ct(d,`border-bottom: 2px solid ${ue??""}`),w!==(w=e(s))&&(p.value=(p.__value=e(s))??""),D(j,` ${e(s)??""}`)},[()=>(e(s),m(()=>ht(e(s))))]),It(M,[],p,()=>(e(s),oe()),oe),c(v,d)}),a(Qe),a(Ee);var Ue=o(Ee,2),Te=o(r(Ue),2);S(()=>{T(),tt(()=>{e(le)})}),X(Te,5,()=>e(le),G,(v,s)=>{var d=da(),p=r(d,!0);a(d);var w={};S(()=>{D(p,e(s)),w!==(w=e(s))&&(d.value=(d.__value=e(s))??"")}),c(v,d)}),a(Te),a(Ue),a(Oe);var He=o(Oe,2);{var Bt=v=>{var s=ca(),d=o(r(s),2),p=r(d,!0);a(d);var w=o(d,2);qt(w,j=>b(V,j),()=>e(V)),a(s),S(()=>D(p,e(We))),c(v,s)};B(He,v=>{e(x),m(()=>e(x).length>0)&&v(Bt)})}var je=o(He,2),Lt=o(r(je),4);{var Nt=v=>{var s=xa(),d=r(s),p=r(d),w=r(p);X(w,5,()=>(e(F),m(()=>e(F)[1])),G,(ae,Y)=>{var N=at(()=>st(e(Y),2));let q=()=>e(N)[0],se=()=>e(N)[1];var C=ua(),z=r(C),Q=r(z),ne=o(Q),ge=r(ne);{var xe=O=>{var U=De();S(()=>D(U,e(Z)==="asc"?"↑":"↓")),c(O,U)},ve=O=>{var U=De("↕");c(O,U)};B(ge,O=>{e(J)===q()?O(xe):O(ve,!1)})}a(ne),a(z),a(C),S(()=>{Gt(C,"title",se()),fe(C,1,`sortable ${e(J)===q()?"sorted":""}`,"svelte-1ud9e95"),D(Q,`${q()??""} `)}),I("click",C,()=>gt(q())),c(ae,C)}),a(w),a(p);var j=o(p);X(j,5,()=>e(E),G,(ae,Y)=>{var N=ba();X(N,5,()=>(e(F),m(()=>e(F)[1])),G,(q,se)=>{var C=at(()=>st(e(se),1));let z=()=>e(C)[0];var Q=pa(),ne=r(Q);Kt(ne,()=>(e(Y),z(),e(F),m(()=>xt(e(Y)[z()],e(F)[2][z()])))),a(Q),c(q,Q)}),a(N),c(ae,N)}),a(j),a(d);var ue=o(d,2);{var Et=ae=>{var Y=ga(),N=r(Y),q=r(N);a(N);var se=o(N,2),C=r(se),z=o(C,2);{var Q=$=>{var pe=ot(),be=he(pe);X(be,1,()=>(e(t),m(()=>Array(e(t)).fill(0))),G,(ke,Je,de,Re)=>{var ce=ma();ce.textContent=de+1,S(()=>fe(ce,1,`page-btn ${e(l)===de+1?"active":""}`,"svelte-1ud9e95")),I("click",ce,()=>ye(de+1)),c(ke,ce)}),c($,pe)},ne=$=>{var pe=ya(),be=he(pe),ke=o(be,2);{var Je=R=>{var Me=_a();c(R,Me)};B(ke,R=>{e(l)>3&&R(Je)})}var de=o(ke,2);X(de,0,()=>m(()=>Array(3).fill(0)),G,(R,Me,me,Da)=>{var Ze=ot(),jt=he(Ze);{var zt=Ae=>{var _e=ha(),Rt=r(_e,!0);a(_e),S(()=>{fe(_e,1,`page-btn ${e(l)===e(l)+me-1?"active":""}`,"svelte-1ud9e95"),D(Rt,e(l)+me-1)}),I("click",_e,()=>ye(e(l)+me-1)),c(Ae,_e)};B(jt,Ae=>{e(l)+me-1>1&&e(l)+me-1<e(t)&&Ae(zt)})}c(R,Ze)});var Re=o(de,2);{var ce=R=>{var Me=fa();c(R,Me)};B(Re,R=>{e(l)<e(t)-2&&R(ce)})}var Se=o(Re,2),Tt=r(Se,!0);a(Se),S(()=>{fe(be,1,`page-btn ${e(l)===1?"active":""}`,"svelte-1ud9e95"),fe(Se,1,`page-btn ${e(l)===e(t)?"active":""}`,"svelte-1ud9e95"),D(Tt,e(t))}),I("click",be,()=>ye(1)),I("click",Se,()=>ye(e(t))),c($,pe)};B(z,$=>{e(t)<=7?$(Q):$(ne,!1)})}var ge=o(z,2);a(se);var xe=o(se,2),ve=o(r(xe),2);S(()=>{e(P),tt(()=>{e(l)})});var O=r(ve);O.value=O.__value=25;var U=o(O);U.value=U.__value=50;var ze=o(U);ze.value=ze.__value=100;var Ke=o(ze);Ke.value=Ke.__value=200,a(ve),a(xe),a(Y),S($=>{D(q,`Showing ${(e(l)-1)*e(P)+1}-${$??""} of ${e(u),m(()=>e(u).length)??""} results`),C.disabled=e(l)===1,ge.disabled=e(l)===e(t)},[()=>(e(l),e(P),e(u),m(()=>Math.min(e(l)*e(P),e(u).length)))]),I("click",C,yt),I("click",ge,ft),lt(ve,()=>e(P),$=>b(P,$)),I("change",ve,()=>b(l,1)),c(ae,Y)};B(ue,ae=>{e(t)>1&&ae(Et)})}a(s),c(v,s)},Ot=v=>{var s=ka();c(v,s)};B(Lt,v=>{e(x),m(()=>e(x).length>0)?v(Nt):v(Ot,!1)})}a(je);var Ie=o(je,2),Xe=o(r(Ie),2),Ge=r(Xe),$t=r(Ge,!0);a(Ge),a(Xe),a(Ie),S(()=>{D(Ct,(e(ie),m(()=>e(ie).hasBackground?"included":"does not include"))),D($t,(H(g()),m(()=>g().analysis.citation)))}),Xt(qe,K),lt(Te,T),c(n,y)};B(kt,n=>{g()?n(Mt,!1):n(St)})}a(Le),c(h,Le),Wt()}export{Aa as F};
