import{ac as at,ad as fi,ae as pi,af as lt,ag as xi,T as yi,ah as di,ai as q,X as w,aj as ut,W as ft,Z as bi,ak as mi,al as vi,am as wi,an as X,ao as ki,ap as Ti,aq as Ni,ar as gi,as as Ci,at as Ei,au as Si,a1 as I,av as kt,aw as Bi,ax as Ii,ay as P,az as Mi,J as Tt,aA as Xi,aB as Pi,aC as zi,aD as Ri,aE as Gi,aF as Yi,i as Nt,a5 as Fi,aG as Ai,aH as pt,aI as Li}from"./CdoYSR-b.js";function V(t,i){let n=0;for(let e of t)e!=null&&(e=+e)>=e&&++n;return n}function Oi(t){return Math.max(1,Math.ceil(Math.log(V(t))/Math.LN2)+1)}function ji(t,i,n){const e=V(t),s=at(t,.75)-at(t,.25);return e&&s?Math.ceil((n-i)/(2*s*Math.pow(e,-1/3))):1}function gt(t,i,n){const e=V(t),s=fi(t);return e&&s?Math.ceil((n-i)*Math.cbrt(e)/(3.49*s)):1}function g(t){return function(){return t}}function Di(t){let i=3;return t.digits=function(n){if(!arguments.length)return i;if(n==null)i=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);i=e}return t},()=>new pi(i)}function Zi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ct(t){this._context=t}Ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;default:this._context.lineTo(t,i);break}}};function Y(t){return new Ct(t)}function qi(t){return t[0]}function Ki(t){return t[1]}function Fn(t,i){var n=g(!0),e=null,s=Y,o=null,h=Di(r);t=typeof t=="function"?t:t===void 0?qi:g(t),i=typeof i=="function"?i:i===void 0?Ki:g(i);function r(_){var l,a=(_=Zi(_)).length,u,c=!1,f;for(e==null&&(o=s(f=h())),l=0;l<=a;++l)!(l<a&&n(u=_[l],l,_))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+t(u,l,_),+i(u,l,_));if(f)return o=null,f+""||null}return r.x=function(_){return arguments.length?(t=typeof _=="function"?_:g(+_),r):t},r.y=function(_){return arguments.length?(i=typeof _=="function"?_:g(+_),r):i},r.defined=function(_){return arguments.length?(n=typeof _=="function"?_:g(!!_),r):n},r.curve=function(_){return arguments.length?(s=_,e!=null&&(o=s(e)),r):s},r.context=function(_){return arguments.length?(_==null?e=o=null:o=s(e=_),r):e},r}class Et{constructor(i,n){this._context=i,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(i,n){switch(i=+i,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(i,n):this._context.moveTo(i,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+i)/2,this._y0,this._x0,n,i,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,i,this._y0,i,n);break}}this._x0=i,this._y0=n}}function Vi(t){return new Et(t,!0)}function Hi(t){return new Et(t,!1)}function k(){}function z(t,i,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+i)/6,(t._y0+4*t._y1+n)/6)}function F(t){this._context=t}F.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:z(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:z(this,t,i);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=i}};function Ji(t){return new F(t)}function St(t){this._context=t}St.prototype={areaStart:k,areaEnd:k,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._x2=t,this._y2=i;break;case 1:this._point=2,this._x3=t,this._y3=i;break;case 2:this._point=3,this._x4=t,this._y4=i,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+i)/6);break;default:z(this,t,i);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=i}};function Wi(t){return new St(t)}function Bt(t){this._context=t}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,e=(this._y0+4*this._y1+i)/6;this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 3:this._point=4;default:z(this,t,i);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=i}};function Qi(t){return new Bt(t)}function It(t,i){this._basis=new F(t),this._beta=i}It.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,i=this._y,n=t.length-1;if(n>0)for(var e=t[0],s=i[0],o=t[n]-e,h=i[n]-s,r=-1,_;++r<=n;)_=r/n,this._basis.point(this._beta*t[r]+(1-this._beta)*(e+_*o),this._beta*i[r]+(1-this._beta)*(s+_*h));this._x=this._y=null,this._basis.lineEnd()},point:function(t,i){this._x.push(+t),this._y.push(+i)}};const Ui=function t(i){function n(e){return i===1?new F(e):new It(e,i)}return n.beta=function(e){return t(+e)},n}(.85);function R(t,i,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-i),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function H(t,i){this._context=t,this._k=(1-i)/6}H.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:R(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2,this._x1=t,this._y1=i;break;case 2:this._point=3;default:R(this,t,i);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const $i=function t(i){function n(e){return new H(e,i)}return n.tension=function(e){return t(+e)},n}(0);function J(t,i){this._context=t,this._k=(1-i)/6}J.prototype={areaStart:k,areaEnd:k,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._x3=t,this._y3=i;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=i);break;case 2:this._point=3,this._x5=t,this._y5=i;break;default:R(this,t,i);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const tn=function t(i){function n(e){return new J(e,i)}return n.tension=function(e){return t(+e)},n}(0);function W(t,i){this._context=t,this._k=(1-i)/6}W.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:R(this,t,i);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const nn=function t(i){function n(e){return new W(e,i)}return n.tension=function(e){return t(+e)},n}(0);function Q(t,i,n){var e=t._x1,s=t._y1,o=t._x2,h=t._y2;if(t._l01_a>lt){var r=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,_=3*t._l01_a*(t._l01_a+t._l12_a);e=(e*r-t._x0*t._l12_2a+t._x2*t._l01_2a)/_,s=(s*r-t._y0*t._l12_2a+t._y2*t._l01_2a)/_}if(t._l23_a>lt){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,a=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-i*t._l12_2a)/a,h=(h*l+t._y1*t._l23_2a-n*t._l12_2a)/a}t._context.bezierCurveTo(e,s,o,h,t._x2,t._y2)}function Mt(t,i){this._context=t,this._alpha=i}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){if(t=+t,i=+i,this._point){var n=this._x2-t,e=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+e*e,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;break;case 2:this._point=3;default:Q(this,t,i);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const en=function t(i){function n(e){return i?new Mt(e,i):new H(e,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Xt(t,i){this._context=t,this._alpha=i}Xt.prototype={areaStart:k,areaEnd:k,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,i){if(t=+t,i=+i,this._point){var n=this._x2-t,e=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+e*e,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=i;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=i);break;case 2:this._point=3,this._x5=t,this._y5=i;break;default:Q(this,t,i);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const sn=function t(i){function n(e){return i?new Xt(e,i):new J(e,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Pt(t,i){this._context=t,this._alpha=i}Pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){if(t=+t,i=+i,this._point){var n=this._x2-t,e=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+e*e,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Q(this,t,i);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const on=function t(i){function n(e){return i?new Pt(e,i):new W(e,0)}return n.alpha=function(e){return t(+e)},n}(.5);function zt(t){this._context=t}zt.prototype={areaStart:k,areaEnd:k,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,i){t=+t,i=+i,this._point?this._context.lineTo(t,i):(this._point=1,this._context.moveTo(t,i))}};function _n(t){return new zt(t)}function xt(t){return t<0?-1:1}function yt(t,i,n){var e=t._x1-t._x0,s=i-t._x1,o=(t._y1-t._y0)/(e||s<0&&-0),h=(n-t._y1)/(s||e<0&&-0),r=(o*s+h*e)/(e+s);return(xt(o)+xt(h))*Math.min(Math.abs(o),Math.abs(h),.5*Math.abs(r))||0}function dt(t,i){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-i)/2:i}function K(t,i,n){var e=t._x0,s=t._y0,o=t._x1,h=t._y1,r=(o-e)/3;t._context.bezierCurveTo(e+r,s+r*i,o-r,h-r*n,o,h)}function G(t){this._context=t}G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:K(this,this._t0,dt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){var n=NaN;if(t=+t,i=+i,!(t===this._x1&&i===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;break;case 2:this._point=3,K(this,dt(this,n=yt(this,t,i)),n);break;default:K(this,this._t0,n=yt(this,t,i));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=i,this._t0=n}}};function Rt(t){this._context=new Gt(t)}(Rt.prototype=Object.create(G.prototype)).point=function(t,i){G.prototype.point.call(this,i,t)};function Gt(t){this._context=t}Gt.prototype={moveTo:function(t,i){this._context.moveTo(i,t)},closePath:function(){this._context.closePath()},lineTo:function(t,i){this._context.lineTo(i,t)},bezierCurveTo:function(t,i,n,e,s,o){this._context.bezierCurveTo(i,t,e,n,o,s)}};function hn(t){return new G(t)}function rn(t){return new Rt(t)}function Yt(t){this._context=t}Yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,i=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],i[0]):this._context.moveTo(t[0],i[0]),n===2)this._context.lineTo(t[1],i[1]);else for(var e=bt(t),s=bt(i),o=0,h=1;h<n;++o,++h)this._context.bezierCurveTo(e[0][o],s[0][o],e[1][o],s[1][o],t[h],i[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,i){this._x.push(+t),this._y.push(+i)}};function bt(t){var i,n=t.length-1,e,s=new Array(n),o=new Array(n),h=new Array(n);for(s[0]=0,o[0]=2,h[0]=t[0]+2*t[1],i=1;i<n-1;++i)s[i]=1,o[i]=4,h[i]=4*t[i]+2*t[i+1];for(s[n-1]=2,o[n-1]=7,h[n-1]=8*t[n-1]+t[n],i=1;i<n;++i)e=s[i]/o[i-1],o[i]-=e,h[i]-=e*h[i-1];for(s[n-1]=h[n-1]/o[n-1],i=n-2;i>=0;--i)s[i]=(h[i]-s[i+1])/o[i];for(o[n-1]=(t[n]+s[n-1])/2,i=0;i<n-1;++i)o[i]=2*t[i+1]-s[i+1];return[s,o]}function cn(t){return new Yt(t)}function A(t,i){this._context=t,this._t=i}A.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,i),this._context.lineTo(t,i);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,i)}break}}this._x=t,this._y=i}};function an(t){return new A(t,.5)}function ln(t){return new A(t,0)}function un(t){return new A(t,1)}const fn=new Map([["basis",Ji],["basis-closed",Wi],["basis-open",Qi],["bundle",Ui],["bump-x",Vi],["bump-y",Hi],["cardinal",$i],["cardinal-closed",tn],["cardinal-open",nn],["catmull-rom",en],["catmull-rom-closed",sn],["catmull-rom-open",on],["linear",Y],["linear-closed",_n],["monotone-x",hn],["monotone-y",rn],["natural",cn],["step",an],["step-after",un],["step-before",ln]]);function pn(t=Y,i){if(typeof t=="function")return t;const n=fn.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${t}`);if(i!==void 0){if("beta"in n)return n.beta(i);if("tension"in n)return n.tension(i);if("alpha"in n)return n.alpha(i)}return n}function An(t=mt,i){return typeof t!="function"&&`${t}`.toLowerCase()==="auto"?mt:pn(t,i)}function mt(t){return Y(t)}function xn(t={y:"count"},i={}){[t,i]=bn(t,i);const{x:n,y:e}=i;return dn(mn(n,i,Nt),null,null,e,t,xi(i))}function yn(t,i,n={}){if((n==null?void 0:n.interval)==null)return n;const{reduce:e=wi}=n,s={filter:null};return n[i]!=null&&(s[i]=e),n[`${i}1`]!=null&&(s[`${i}1`]=e),n[`${i}2`]!=null&&(s[`${i}2`]=e),t(s,n)}function Ln(t={}){return yn(xn,"y",yi(t,"x"))}function dn(t,i,n,e,{data:s=mi,filter:o=di,sort:h,reverse:r,..._}={},l={}){t=vt(t),i=vt(i),_=wn(_,l),s=Lt(s,Nt),h=h==null?void 0:Ft("sort",h,l),o=o==null?void 0:At("filter",o,l),e!=null&&q(_,"y","y1","y2")&&(e=null);const[a,u]=w(t),[c,f]=w(t),[p,b]=w(i),[v,x]=w(i),[$,tt]=e!=null?[e,"y"]:[],[it,jt]=w($),{x:Dt,y:Zt,z:L,fill:nt,stroke:et,x1:qt,x2:Kt,y1:Vt,y2:Ht,domain:Pn,cumulative:zn,thresholds:Rn,interval:Gn,...Jt}=l,[Wt,Qt]=w(L),[st]=ut(nt),[ot]=ut(et),[Ut,$t]=w(st),[ti,ii]=w(ot);return{..."z"in l&&{z:Wt||L},..."fill"in l&&{fill:Ut||nt},..."stroke"in l&&{stroke:ti||et},...bi(Jt,(y,O,j)=>{const D=Fi(I(y,$),j==null?void 0:j[tt]),C=I(y,L),E=I(y,st),S=I(y,ot),B=Ai(_,{z:C,fill:E,stroke:S}),Z=[],_t=[],ni=D&&jt([]),ei=C&&Qt([]),si=E&&$t([]),oi=S&&ii([]),ht=t&&u([]),_i=t&&f([]),rt=i&&b([]),hi=i&&x([]),ri=Nn(t,i,y);let ci=0;for(const T of _)T.initialize(y);h&&h.initialize(y),o&&o.initialize(y);for(const T of O){const ct=[];for(const N of _)N.scope("facet",T);h&&h.scope("facet",T),o&&o.scope("facet",T);for(const[N,ai]of pt(T,B))for(const[li,M]of pt(ai,D))for(const[d,m]of ri(M))if(B&&(m.z=N),!(o&&!o.reduce(d,m))){ct.push(ci++),_t.push(s.reduceIndex(d,y,m)),D&&ni.push(li),C&&ei.push(B===C?N:C[(d.length>0?d:M)[0]]),E&&si.push(B===E?N:E[(d.length>0?d:M)[0]]),S&&oi.push(B===S?N:S[(d.length>0?d:M)[0]]),ht&&(ht.push(m.x1),_i.push(m.x2)),rt&&(rt.push(m.y1),hi.push(m.y2));for(const ui of _)ui.reduce(d,m);h&&h.reduce(d,m)}Z.push(ct)}return Li(Z,h,r),{data:_t,facets:Z}}),...!q(_,"x")&&(a?{x1:a,x2:c,x:ft(a,c)}:{x:Dt,x1:qt,x2:Kt}),...!q(_,"y")&&(p?{y1:p,y2:v,y:ft(p,v)}:{y:Zt,y1:Vt,y2:Ht}),...it&&{[tt]:it},...Object.fromEntries(_.map(({name:y,output:O})=>[y,O]))}}function bn({cumulative:t,domain:i,thresholds:n,interval:e,...s},o){return[s,{cumulative:t,domain:i,thresholds:n,interval:e,...o}]}function mn(t,{cumulative:i,domain:n,thresholds:e,interval:s},o){return t={...vi(t)},t.domain===void 0&&(t.domain=n),t.cumulative===void 0&&(t.cumulative=i),t.thresholds===void 0&&(t.thresholds=e),t.interval===void 0&&(t.interval=s),t.value===void 0&&(t.value=o),t.thresholds=vn(t.thresholds,t.interval),t}function vt(t){if(t==null)return;const{value:i,cumulative:n,domain:e=X,thresholds:s}=t,o=h=>{let r=I(h,i),_;if(kt(r)||Tn(s)){r=Bi(r,Ii,Float64Array);let[a,u]=typeof e=="function"?e(r):e,c=typeof s=="function"&&!P(s)?s(r,a,u):s;typeof c=="number"&&(c=Mi(a,u,c)),P(c)&&(e===X&&(a=c.floor(a),u=c.offset(c.floor(u))),c=c.range(a,c.offset(u))),_=c}else{r=Tt(r);let[a,u]=typeof e=="function"?e(r):e,c=typeof s=="function"&&!P(s)?s(r,a,u):s;if(typeof c=="number")if(e===X){let f=Xi(a,u,c);if(isFinite(f))if(f>0){let p=Math.round(a/f),b=Math.round(u/f);p*f<=a||--p,b*f>u||++b;let v=b-p+1;c=new Float64Array(v);for(let x=0;x<v;++x)c[x]=(p+x)*f}else if(f<0){f=-f;let p=Math.round(a*f),b=Math.round(u*f);p/f<=a||--p,b/f>u||++b;let v=b-p+1;c=new Float64Array(v);for(let x=0;x<v;++x)c[x]=(p+x)/f}else c=[a];else c=[a]}else c=Pi(a,u,c);else P(c)&&(e===X&&(a=c.floor(a),u=c.offset(c.floor(u))),c=c.range(a,c.offset(u)));_=c}const l=[];if(_.length===1)l.push([_[0],_[0]]);else for(let a=1;a<_.length;++a)l.push([_[a-1],_[a]]);return l.bin=(n<0?Cn:n>0?gn:U)(l,_,r),l};return o.label=ki(i),o}function vn(t,i,n=wt){if(t===void 0)return i===void 0?n:Ei(i);if(typeof t=="string"){switch(t.toLowerCase()){case"freedman-diaconis":return ji;case"scott":return gt;case"sturges":return Oi;case"auto":return wt}return Si(t)}return t}function wn(t,i){return Ti(t,i,Ft)}function Ft(t,i,n){return gi(t,i,n,At)}function At(t,i,n){return Ci(t,i,n,Lt)}function Lt(t,i){return Ni(t,i,kn)}function kn(t){switch(`${t}`.toLowerCase()){case"x":return En;case"x1":return Bn;case"x2":return In;case"y":return Sn;case"y1":return Mn;case"y2":return Xn;case"z":return zi}throw new Error(`invalid bin reduce: ${t}`)}function wt(t,i,n){return Math.min(200,gt(t,i,n))}function Tn(t){return Ri(t)||Gi(t)&&kt(t)}function Nn(t,i,n){const e=t==null?void 0:t(n),s=i==null?void 0:i(n);return e&&s?function*(o){const h=e.bin(o);for(const[r,[_,l]]of e.entries()){const a=s.bin(h[r]);for(const[u,[c,f]]of s.entries())yield[a[u],{data:n,x1:_,y1:c,x2:l,y2:f}]}}:e?function*(o){const h=e.bin(o);for(const[r,[_,l]]of e.entries())yield[h[r],{data:n,x1:_,x2:l}]}:function*(o){const h=s.bin(o);for(const[r,[_,l]]of s.entries())yield[h[r],{data:n,y1:_,y2:l}]}}function U(t,i,n){return i=Tt(i),e=>{var o;const s=t.map(()=>[]);for(const h of e)(o=s[Yi(i,n[h])-1])==null||o.push(h);return s}}function gn(t,i,n){const e=U(t,i,n);return s=>{const o=e(s);for(let h=1,r=o.length;h<r;++h){const _=o[h-1],l=o[h];for(const a of _)l.push(a)}return o}}function Cn(t,i,n){const e=U(t,i,n);return s=>{const o=e(s);for(let h=o.length-2;h>=0;--h){const r=o[h+1],_=o[h];for(const l of r)_.push(l)}return o}}function Ot(t,i){const n=(+t+ +i)/2;return t instanceof Date?new Date(n):n}const En={reduceIndex(t,i,{x1:n,x2:e}){return Ot(n,e)}},Sn={reduceIndex(t,i,{y1:n,y2:e}){return Ot(n,e)}},Bn={reduceIndex(t,i,{x1:n}){return n}},In={reduceIndex(t,i,{x2:n}){return n}},Mn={reduceIndex(t,i,{y1:n}){return n}},Xn={reduceIndex(t,i,{y2:n}){return n}};export{Ln as a,xn as b,mt as c,Zi as d,Y as e,g as f,pn as g,An as m,Fn as s,Di as w,qi as x,Ki as y};
