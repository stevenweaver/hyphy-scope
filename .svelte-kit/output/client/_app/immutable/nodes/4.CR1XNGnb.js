import"../chunks/CWj6FrbW.js";import"../chunks/Dh1LkfYh.js";import{o as ee}from"../chunks/BVXFiTq-.js";import{p as se,i as e,q as B,A as oe,y as Q,o as t,j as Z,z as re,f as m,c as i,r as a,a as g,m as te,s as v,x as ae,n as b,t as T,e as $,$ as ne,v as ve,w as ce}from"../chunks/CGZSrXyu.js";import{s as L,h as de,e as j}from"../chunks/BzHdtkot.js";import{i as F,b as ue}from"../chunks/JwmFF-xm.js";import{e as pe,b as fe,a as ge,g as me,i as he,r as xe,l as _e,c as be}from"../chunks/BM8ST8i7.js";import{i as ie}from"../chunks/ui6rPYHM.js";import{z as ye,D as we}from"../chunks/CKo-VmNz.js";import{p as Be}from"../chunks/BWiVFVQA.js";import{b as Se}from"../chunks/VyfRdQgz.js";var Me=m('<div class="loading svelte-295fdw">Loading BGM data...</div>'),Le=m('<div class="summary-tiles svelte-295fdw"><div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Sequences</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Sites</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Tested Pairs</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw" style="color: #e3243b"> </div> <div class="tile-description svelte-295fdw">Significant Correlations</div></div></div>'),Ce=m('<div class="analysis-info svelte-295fdw"><h2 class="svelte-295fdw">BGM Analysis Results</h2> <p><strong>Bayesian Graphical Model</strong> for detecting correlated evolution between sites.</p></div> <!> <div class="plot-section svelte-295fdw"><h3 class="svelte-295fdw">Site Correlations</h3> <div class="plot-container svelte-295fdw"></div></div> <div class="citation svelte-295fdw"><h3 class="svelte-295fdw">Citation</h3> <code class="svelte-295fdw">Poon AFY, Lewis FI, Pond SLK, Frost SDW. An evolutionary-network model reveals stratified interactions in the V3 loop of the HIV-1 envelope. PLoS Comput Biol. 2007;3(11):e231.</code></div>',1),De=m('<div class="bgm-visualization svelte-295fdw"><!></div>');function Fe(H,A){se(A,!1);const r=B(),n=B();let c=Be(A,"data",8),f=B();function S(l){var h,p;const d=l["test results"]||{};return{sequences:((h=l.input)==null?void 0:h.sequences)||0,sites:((p=l.input)==null?void 0:p.sites)||0,partitions:Object.keys(l["data partitions"]||{}).length,correlations:Object.keys(d).length,significantCorrelations:Object.values(d).filter(x=>(x["p-value"]||1)<=.05).length}}function J(l){const d=l["test results"]||{};return Object.entries(d).map(([h,p])=>({pair:h,correlation:p.correlation||0,pValue:p["p-value"]||1,significant:(p["p-value"]||1)<=.05}))}function I(l){return l.length?ye({title:"Site-to-Site Correlations",width:800,height:400,x:{label:"Site Pair",type:"band"},y:{label:"Correlation Coefficient",grid:!0},color:{legend:!0},marks:[we([0],{stroke:"#666",strokeDasharray:"3,3"}),Se(l,{x:"pair",y:"correlation",fill:"significant",title:d=>`${d.pair}
Correlation: ${d.correlation.toFixed(3)}
p-value: ${d.pValue.toFixed(4)}`})]}):null}ee(()=>{e(n).length>0&&E()});function E(){if(e(f)){const l=I(e(n));l&&(oe(f,e(f).innerHTML=""),e(f).appendChild(l))}}Q(()=>Z(c()),()=>{t(r,c()?S(c()):null)}),Q(()=>Z(c()),()=>{t(n,c()?J(c()):[])}),Q(()=>e(n),()=>{e(n).length>0&&E()}),re(),ie();var G=De(),Y=i(G);{var k=l=>{var d=Me();g(l,d)},P=l=>{var d=Ce(),h=v(ae(d),2);{var p=_=>{var C=Le(),y=i(C),U=i(y),N=i(U,!0);a(U),b(2),a(y);var D=v(y,2),z=i(D),W=i(z,!0);a(z),b(2),a(D);var R=v(D,2),O=i(R),X=i(O,!0);a(O),b(2),a(R);var q=v(R,2),V=i(q),s=i(V,!0);a(V),b(2),a(q),a(C),T(()=>{L(N,(e(r),$(()=>e(r).sequences))),L(W,(e(r),$(()=>e(r).sites))),L(X,(e(r),$(()=>e(r).correlations))),L(s,(e(r),$(()=>e(r).significantCorrelations)))}),g(_,C)};F(h,_=>{e(r)&&_(p)})}var x=v(h,2),K=v(i(x),2);ue(K,_=>t(f,_),()=>e(f)),a(x),b(2),g(l,d)};F(Y,l=>{c()?l(P,!1):l(k)})}a(G),g(H,G),te()}var Ge=m('<meta name="description" content="Interactive visualization of BGM (Bayesian Graphical Model) analysis results"/>'),ke=m("<option> </option>"),Pe=m('<div class="status loading svelte-2x16si"><p>Loading data...</p></div>'),Ue=m('<div class="status error svelte-2x16si"><p> </p> <button class="svelte-2x16si">Dismiss</button></div>'),ze=m('<div class="visualization-section svelte-2x16si"><!></div>'),Re=m('<div class="no-data svelte-2x16si"><h3>No Data Loaded</h3> <p>Please load BGM analysis data using one of the options above to see the visualization.</p></div>'),Te=m(`<div class="bgm-demo svelte-2x16si"><div class="header svelte-2x16si"><h1 class="svelte-2x16si">BGM Analysis</h1> <p class="svelte-2x16si">Interactive visualization of Bayesian Graphical Model analysis.
      BGM detects correlated evolution between sites using graphical models.</p></div> <div class="data-loading svelte-2x16si"><h2>Load Data</h2> <div class="loading-options svelte-2x16si"><div class="option svelte-2x16si"><h3 class="svelte-2x16si">Test Data</h3> <div class="test-data-controls svelte-2x16si"><select class="svelte-2x16si"></select> <button class="svelte-2x16si"> </button></div> <p class="help svelte-2x16si">Load example data to explore the visualization features.</p></div> <div class="option svelte-2x16si"><h3 class="svelte-2x16si">Load from URL</h3> <div class="url-input svelte-2x16si"><input type="url" placeholder="Enter JSON file URL..." class="svelte-2x16si"/> <button class="svelte-2x16si">Load</button></div> <p class="help svelte-2x16si">Load BGM results from a remote JSON file.</p></div> <div class="option svelte-2x16si"><h3 class="svelte-2x16si">Upload File</h3> <input type="file" accept=".json,.gz" class="svelte-2x16si"/> <p class="help svelte-2x16si">Upload a local BGM JSON file from your computer.</p></div></div> <!> <!></div> <!> <div class="usage-info svelte-2x16si"><h2 class="svelte-2x16si">About BGM</h2> <h3 class="svelte-2x16si">What is BGM?</h3> <p><strong>BGM (Bayesian Graphical Model)</strong> is a method for detecting correlated 
      evolution between sites in protein-coding sequences. It uses probabilistic graphical 
      models to identify pairs of sites that evolve in a coordinated manner.</p> <h3 class="svelte-2x16si">Key Features</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>Bayesian framework:</strong> Uses Bayesian inference for model selection</li> <li class="svelte-2x16si"><strong>Graphical models:</strong> Models dependencies between sites</li> <li class="svelte-2x16si"><strong>Correlation detection:</strong> Identifies correlated evolutionary patterns</li> <li class="svelte-2x16si"><strong>Network analysis:</strong> Reveals evolutionary networks between sites</li> <li class="svelte-2x16si"><strong>Statistical rigor:</strong> Provides posterior probabilities for correlations</li></ul> <h3 class="svelte-2x16si">Interpretation</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>High correlation:</strong> Sites evolve together (functional/structural constraints)</li> <li class="svelte-2x16si"><strong>Positive correlation:</strong> Similar evolutionary pressures</li> <li class="svelte-2x16si"><strong>Negative correlation:</strong> Compensatory changes</li> <li class="svelte-2x16si"><strong>p-value &lt; 0.05:</strong> Significant evidence for correlation</li> <li class="svelte-2x16si"><strong>Network structure:</strong> Reveals functional domains or interactions</li></ul> <h3 class="svelte-2x16si">Using This Component</h3> <pre class="svelte-2x16si"><code class="svelte-2x16si">import &#123; BgmVisualization &#125; from 'hyphy-scope';

&lt;BgmVisualization data=&#123;bgmResults&#125; /&gt;</code></pre> <h3 class="svelte-2x16si">Data Format</h3> <p>The component expects BGM analysis results in JSON format with the following structure:</p> <ul class="svelte-2x16si"><li class="svelte-2x16si"><code class="svelte-2x16si">test results</code> - Correlation results for site pairs</li> <li class="svelte-2x16si"><code class="svelte-2x16si">data partitions</code> - Partition information for sites</li> <li class="svelte-2x16si"><code class="svelte-2x16si">input</code> - Input parameters (sequences, sites)</li></ul> <h3 class="svelte-2x16si">Applications</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>Protein structure:</strong> Identify structurally interacting residues</li> <li class="svelte-2x16si"><strong>Functional domains:</strong> Discover co-evolving functional regions</li> <li class="svelte-2x16si"><strong>Compensatory mutations:</strong> Find sites with coordinated changes</li> <li class="svelte-2x16si"><strong>Drug resistance:</strong> Understand resistance mutation networks</li></ul></div></div>`);function Ye(H,A){se(A,!1);let r=B(null),n=B(!1),c=B(""),f=B(""),S=B("bgm");const J=[{value:"fel",label:"FEL"},{value:"meme",label:"MEME"},{value:"absrel",label:"aBSREL"},{value:"busted",label:"BUSTED"},{value:"relax",label:"RELAX"},{value:"slac",label:"SLAC"},{value:"bgm",label:"BGM"}];ee(async()=>{await I()});async function I(){try{t(n,!0),t(c,""),t(r,await me(e(S)))}catch(s){t(c,`Failed to load ${e(S).toUpperCase()} test data: ${s.message}`),t(r,null)}finally{t(n,!1)}}async function E(){if(!e(f).trim()){t(c,"Please enter a valid URL");return}try{t(n,!0),t(c,""),t(r,await _e(e(f)))}catch(s){t(c,`Failed to load data from URL: ${s.message}`),t(r,null)}finally{t(n,!1)}}async function G(s){var u;const o=(u=s.target.files)==null?void 0:u[0];if(o)try{t(n,!0),t(c,""),t(r,await be(o))}catch(M){t(c,`Failed to load file: ${M.message}`),t(r,null)}finally{t(n,!1)}}function Y(){t(c,"")}ie();var k=Te();de(s=>{var o=Ge();ne.title="BGM Analysis - HyPhy Scope",g(s,o)});var P=v(i(k),2),l=v(i(P),2),d=i(l),h=v(i(d),2),p=i(h);T(()=>{e(S),ve(()=>{})}),pe(p,5,()=>J,he,(s,o)=>{var u=ke(),M=i(u,!0);a(u);var w={};T(()=>{L(M,e(o).label),w!==(w=e(o).value)&&(u.value=(u.__value=e(o).value)??"")}),g(s,u)}),a(p);var x=v(p,2),K=i(x,!0);a(x),a(h),b(2),a(d);var _=v(d,2),C=v(i(_),2),y=i(C);xe(y);var U=v(y,2);a(C),b(2),a(_);var N=v(_,2),D=v(i(N),2);b(2),a(N),a(l);var z=v(l,2);{var W=s=>{var o=Pe();g(s,o)};F(z,s=>{e(n)&&s(W)})}var R=v(z,2);{var O=s=>{var o=Ue(),u=i(o),M=i(u,!0);a(u);var w=v(u,2);a(o),T(()=>L(M,e(c))),j("click",w,Y),g(s,o)};F(R,s=>{e(c)&&s(O)})}a(P);var X=v(P,2);{var q=s=>{var o=ze(),u=i(o);Fe(u,{get data(){return e(r)}}),a(o),g(s,o)},V=s=>{var o=ce(),u=ae(o);{var M=w=>{var le=Re();g(w,le)};F(u,w=>{e(n)||w(M)},!0)}g(s,o)};F(X,s=>{e(r)?s(q):s(V,!1)})}b(2),a(k),T(s=>{x.disabled=e(n),L(K,e(n)?"Loading...":"Load Test Data"),y.disabled=e(n),U.disabled=s,D.disabled=e(n)},[()=>e(n)||!e(f).trim()]),fe(p,()=>e(S),s=>t(S,s)),j("click",x,I),ge(y,()=>e(f),s=>t(f,s)),j("click",U,E),j("change",D,G),g(H,k),te()}export{Ye as component};
