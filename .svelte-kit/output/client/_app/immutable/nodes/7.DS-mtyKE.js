import"../chunks/CWj6FrbW.js";import"../chunks/Dh1LkfYh.js";import{o as te}from"../chunks/BVXFiTq-.js";import{p as se,i as e,q as F,A as re,y as Q,o as s,j as Z,z as ne,f as b,c as l,r as a,a as u,m as ae,s as v,x as le,n as D,t as q,e as L,$ as ve,v as ce,w as pe}from"../chunks/CGZSrXyu.js";import{s as E,h as de,e as V}from"../chunks/BzHdtkot.js";import{i as S,b as ge}from"../chunks/JwmFF-xm.js";import{e as me,b as ue,a as fe,g as he,i as be,r as _e,l as De,c as ye}from"../chunks/BM8ST8i7.js";import{i as ie}from"../chunks/ui6rPYHM.js";import{z as xe,D as Fe}from"../chunks/CKo-VmNz.js";import{s as ee}from"../chunks/BR0iTFIE.js";import{p as Ae}from"../chunks/BWiVFVQA.js";import{b as ke}from"../chunks/VyfRdQgz.js";var Ee=b('<div class="loading svelte-8tjx1k">Loading FADE data...</div>'),Be=b('<div class="summary-tiles svelte-8tjx1k"><div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Sequences</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Sites</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">p-value</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Directional Bias</div></div></div>'),je=b('<div class="analysis-info svelte-8tjx1k"><h2 class="svelte-8tjx1k">FADE Analysis Results</h2> <p><strong>FUBAR Approach to Directional Evolution</strong> tests for directional selection toward specific amino acids.</p></div> <!> <div class="plot-section svelte-8tjx1k"><h3 class="svelte-8tjx1k">Directional Selection Bias</h3> <div class="plot-container svelte-8tjx1k"></div></div> <div class="citation svelte-8tjx1k"><h3 class="svelte-8tjx1k">Citation</h3> <code class="svelte-8tjx1k">Kosakovsky Pond SL, Poon AFY, Leigh Brown AJ, Frost SDW. A maximum likelihood method for detecting directional evolution in protein sequences and its application to influenza A virus. Mol Biol Evol. 2008;25(9):1809-24.</code></div>',1),Le=b('<div class="fade-visualization svelte-8tjx1k"><!></div>');function Se(H,I){se(I,!1);const i=F(),n=F();let c=Ae(I,"data",8),g=F();function A(o){var f,h;const p=o["test results"]||{};return{sequences:((f=o.input)==null?void 0:f.sequences)||0,sites:((h=o.input)==null?void 0:h.sites)||0,partitions:Object.keys(o["data partitions"]||{}).length,pValue:p["p-value"]||1,lrt:p.LRT||0,hasDirectionalBias:(p["p-value"]||1)<=.05}}function Y(o){const p=o["branch attributes"]||{},f=[];return Object.entries(p).forEach(([h,m])=>{m&&m.bias&&f.push({branch:h,bias:m.bias,direction:m.bias>0?"Positive":"Negative"})}),f}function N(o){return o.length?xe({title:"Directional Selection Bias",width:800,height:300,x:{label:"Branch",type:"band"},y:{label:"Bias Score",grid:!0},color:{legend:!0},marks:[Fe([0],{stroke:"#666",strokeDasharray:"3,3"}),ke(o,{x:"branch",y:"bias",fill:"direction",title:p=>`${p.branch}
Bias: ${p.bias.toFixed(3)}
Direction: ${p.direction}`})]}):null}te(()=>{e(n).length>0&&C()});function C(){if(e(g)){const o=N(e(n));o&&(re(g,e(g).innerHTML=""),e(g).appendChild(o))}}Q(()=>Z(c()),()=>{s(i,c()?A(c()):null)}),Q(()=>Z(c()),()=>{s(n,c()?Y(c()):[])}),Q(()=>e(n),()=>{e(n).length>0&&C()}),ne(),ie();var U=Le(),K=l(U);{var R=o=>{var p=Ee();u(o,p)},w=o=>{var p=je(),f=v(le(p),2);{var h=_=>{var B=Be(),y=l(B),T=l(y),O=l(T,!0);a(T),D(2),a(y);var j=v(y,2),z=l(j),X=l(z,!0);a(z),D(2),a(j);var P=v(j,2),M=l(P),G=l(M,!0);a(M),D(2),a(P);var J=v(P,2),$=l(J),t=l($,!0);a($),D(2),a(J),a(B),q(r=>{E(O,(e(i),L(()=>e(i).sequences))),E(X,(e(i),L(()=>e(i).sites))),ee(M,`color: ${e(i),L(()=>e(i).hasDirectionalBias?"#e3243b":"#666")??""}`),E(G,r),ee($,`color: ${e(i),L(()=>e(i).hasDirectionalBias?"#e3243b":"#666")??""}`),E(t,(e(i),L(()=>e(i).hasDirectionalBias?"YES":"NO")))},[()=>(e(i),L(()=>e(i).pValue.toExponential(3)))]),u(_,B)};S(f,_=>{e(i)&&_(h)})}var m=v(f,2),W=v(l(m),2);ge(W,_=>s(g,_),()=>e(g)),a(m),D(2),u(o,p)};S(K,o=>{c()?o(w,!1):o(R)})}a(U),u(H,U),ae()}var Ue=b('<meta name="description" content="Interactive visualization of FADE (FUBAR Approach to Directional Evolution) analysis results"/>'),Re=b("<option> </option>"),we=b('<div class="status loading svelte-14pglpm"><p>Loading data...</p></div>'),Te=b('<div class="status error svelte-14pglpm"><p> </p> <button class="svelte-14pglpm">Dismiss</button></div>'),ze=b('<div class="visualization-section svelte-14pglpm"><!></div>'),Pe=b('<div class="no-data svelte-14pglpm"><h3>No Data Loaded</h3> <p>Please load FADE analysis data using one of the options above to see the visualization.</p></div>'),Me=b(`<div class="fade-demo svelte-14pglpm"><div class="header svelte-14pglpm"><h1 class="svelte-14pglpm">FADE Analysis</h1> <p class="svelte-14pglpm">Interactive visualization of FUBAR Approach to Directional Evolution analysis.
      FADE tests for directional selection toward specific amino acids.</p></div> <div class="data-loading svelte-14pglpm"><h2>Load Data</h2> <div class="loading-options svelte-14pglpm"><div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Test Data</h3> <div class="test-data-controls svelte-14pglpm"><select class="svelte-14pglpm"></select> <button class="svelte-14pglpm"> </button></div> <p class="help svelte-14pglpm">Load example data to explore the visualization features.</p></div> <div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Load from URL</h3> <div class="url-input svelte-14pglpm"><input type="url" placeholder="Enter JSON file URL..." class="svelte-14pglpm"/> <button class="svelte-14pglpm">Load</button></div> <p class="help svelte-14pglpm">Load FADE results from a remote JSON file.</p></div> <div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Upload File</h3> <input type="file" accept=".json,.gz" class="svelte-14pglpm"/> <p class="help svelte-14pglpm">Upload a local FADE JSON file from your computer.</p></div></div> <!> <!></div> <!> <div class="usage-info svelte-14pglpm"><h2 class="svelte-14pglpm">About FADE</h2> <h3 class="svelte-14pglpm">What is FADE?</h3> <p><strong>FADE (FUBAR Approach to Directional Evolution)</strong> is a maximum likelihood 
      method for testing directional selection toward specific amino acids. It extends FUBAR 
      to detect directional evolutionary bias in protein sequences.</p> <h3 class="svelte-14pglpm">Key Features</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Directional bias:</strong> Tests for selection toward specific amino acids</li> <li class="svelte-14pglpm"><strong>Maximum likelihood:</strong> Uses ML framework for parameter estimation</li> <li class="svelte-14pglpm"><strong>FUBAR extension:</strong> Built on the FUBAR methodology</li> <li class="svelte-14pglpm"><strong>Branch-level analysis:</strong> Detects directional bias on specific branches</li> <li class="svelte-14pglpm"><strong>Statistical testing:</strong> Provides likelihood ratio tests for significance</li></ul> <h3 class="svelte-14pglpm">Interpretation</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Positive bias:</strong> Selection favors specific amino acid changes</li> <li class="svelte-14pglpm"><strong>Negative bias:</strong> Selection disfavors certain amino acid changes</li> <li class="svelte-14pglpm"><strong>Magnitude:</strong> Strength of directional selection pressure</li> <li class="svelte-14pglpm"><strong>p-value &lt; 0.05:</strong> Significant evidence for directional bias</li> <li class="svelte-14pglpm"><strong>Branch patterns:</strong> Reveals lineage-specific directional evolution</li></ul> <h3 class="svelte-14pglpm">Using This Component</h3> <pre class="svelte-14pglpm"><code class="svelte-14pglpm">import &#123; FadeVisualization &#125; from 'hyphy-scope';

&lt;FadeVisualization data=&#123;fadeResults&#125; /&gt;</code></pre> <h3 class="svelte-14pglpm">Data Format</h3> <p>The component expects FADE analysis results in JSON format with the following structure:</p> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><code class="svelte-14pglpm">test results</code> - Statistical test results (p-value, LRT)</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">branch attributes</code> - Branch-specific bias measurements</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">input</code> - Input parameters (sequences, sites)</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">data partitions</code> - Partition information</li></ul> <h3 class="svelte-14pglpm">Applications</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Protein evolution:</strong> Identify directional changes in protein function</li> <li class="svelte-14pglpm"><strong>Host adaptation:</strong> Detect adaptation to new host environments</li> <li class="svelte-14pglpm"><strong>Drug resistance:</strong> Understand directional changes in drug targets</li> <li class="svelte-14pglpm"><strong>Immune escape:</strong> Identify directional evolution in immune-targeted regions</li> <li class="svelte-14pglpm"><strong>Functional shifts:</strong> Detect systematic changes in protein function</li></ul> <h3 class="svelte-14pglpm">Method Comparison</h3> <p>FADE differs from other HyPhy methods:</p> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>vs. FEL/MEME:</strong> Tests directional bias rather than positive selection</li> <li class="svelte-14pglpm"><strong>vs. RELAX:</strong> Detects bias toward specific changes, not intensity changes</li> <li class="svelte-14pglpm"><strong>vs. BUSTED:</strong> Branch-specific rather than gene-wide testing</li> <li class="svelte-14pglpm"><strong>Specialization:</strong> Designed specifically for directional evolution detection</li></ul></div></div>`);function Xe(H,I){se(I,!1);let i=F(null),n=F(!1),c=F(""),g=F(""),A=F("fade");const Y=[{value:"fel",label:"FEL"},{value:"meme",label:"MEME"},{value:"absrel",label:"aBSREL"},{value:"busted",label:"BUSTED"},{value:"relax",label:"RELAX"},{value:"slac",label:"SLAC"},{value:"bgm",label:"BGM"},{value:"fade",label:"FADE"}];te(async()=>{await N()});async function N(){try{s(n,!0),s(c,""),s(i,await he(e(A)))}catch(t){s(c,`Failed to load ${e(A).toUpperCase()} test data: ${t.message}`),s(i,null)}finally{s(n,!1)}}async function C(){if(!e(g).trim()){s(c,"Please enter a valid URL");return}try{s(n,!0),s(c,""),s(i,await De(e(g)))}catch(t){s(c,`Failed to load data from URL: ${t.message}`),s(i,null)}finally{s(n,!1)}}async function U(t){var d;const r=(d=t.target.files)==null?void 0:d[0];if(r)try{s(n,!0),s(c,""),s(i,await ye(r))}catch(k){s(c,`Failed to load file: ${k.message}`),s(i,null)}finally{s(n,!1)}}function K(){s(c,"")}ie();var R=Me();de(t=>{var r=Ue();ve.title="FADE Analysis - HyPhy Scope",u(t,r)});var w=v(l(R),2),o=v(l(w),2),p=l(o),f=v(l(p),2),h=l(f);q(()=>{e(A),ce(()=>{})}),me(h,5,()=>Y,be,(t,r)=>{var d=Re(),k=l(d,!0);a(d);var x={};q(()=>{E(k,e(r).label),x!==(x=e(r).value)&&(d.value=(d.__value=e(r).value)??"")}),u(t,d)}),a(h);var m=v(h,2),W=l(m,!0);a(m),a(f),D(2),a(p);var _=v(p,2),B=v(l(_),2),y=l(B);_e(y);var T=v(y,2);a(B),D(2),a(_);var O=v(_,2),j=v(l(O),2);D(2),a(O),a(o);var z=v(o,2);{var X=t=>{var r=we();u(t,r)};S(z,t=>{e(n)&&t(X)})}var P=v(z,2);{var M=t=>{var r=Te(),d=l(r),k=l(d,!0);a(d);var x=v(d,2);a(r),q(()=>E(k,e(c))),V("click",x,K),u(t,r)};S(P,t=>{e(c)&&t(M)})}a(w);var G=v(w,2);{var J=t=>{var r=ze(),d=l(r);Se(d,{get data(){return e(i)}}),a(r),u(t,r)},$=t=>{var r=pe(),d=le(r);{var k=x=>{var oe=Pe();u(x,oe)};S(d,x=>{e(n)||x(k)},!0)}u(t,r)};S(G,t=>{e(i)?t(J):t($,!1)})}D(2),a(R),q(t=>{m.disabled=e(n),E(W,e(n)?"Loading...":"Load Test Data"),y.disabled=e(n),T.disabled=t,j.disabled=e(n)},[()=>e(n)||!e(g).trim()]),ue(h,()=>e(A),t=>s(A,t)),V("click",m,N),fe(y,()=>e(g),t=>s(g,t)),V("click",T,C),V("change",j,U),u(H,R),ae()}export{Xe as component};
