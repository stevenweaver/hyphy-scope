import"../chunks/CWj6FrbW.js";import"../chunks/O9NtFhcF.js";import{o as te}from"../chunks/Bm-Peyi0.js";import{p as se,o as s,q as _,z as Q,j as Z,i as e,A as re,f as h,c as l,r as a,a as u,m as ae,B as ne,s as n,x as le,n as D,t as I,e as L,$ as ve,v as ce,w as pe}from"../chunks/BrBLfwSL.js";import{s as E,h as de,e as H}from"../chunks/DZG3np5x.js";import{i as S,b as me}from"../chunks/kkMc64k_.js";import{e as ge,b as ue,a as fe,g as he,i as be,r as _e,l as De,c as xe}from"../chunks/CdTtAD6V.js";import{i as ie}from"../chunks/i3jxjd7U.js";import{z as ye,D as Fe}from"../chunks/CdoYSR-b.js";import{s as ee}from"../chunks/GqwecOep.js";import{p as Ae}from"../chunks/DNC5C8Oc.js";import{b as ke}from"../chunks/z60al4It.js";var Ee=h('<div class="loading svelte-8tjx1k">Loading FADE data...</div>'),Be=h('<div class="summary-tiles svelte-8tjx1k"><div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Sequences</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Sites</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">p-value</div></div> <div class="tile svelte-8tjx1k"><div class="tile-number svelte-8tjx1k"> </div> <div class="tile-description svelte-8tjx1k">Directional Bias</div></div></div>'),je=h('<div class="analysis-info svelte-8tjx1k"><h2 class="svelte-8tjx1k">FADE Analysis Results</h2> <p><strong>FUBAR Approach to Directional Evolution</strong> tests for directional selection toward specific amino acids.</p></div> <!> <div class="plot-section svelte-8tjx1k"><h3 class="svelte-8tjx1k">Directional Selection Bias</h3> <div class="plot-container svelte-8tjx1k"></div></div> <div class="citation svelte-8tjx1k"><h3 class="svelte-8tjx1k">Citation</h3> <code class="svelte-8tjx1k">Kosakovsky Pond SL, Poon AFY, Leigh Brown AJ, Frost SDW. A maximum likelihood method for detecting directional evolution in protein sequences and its application to influenza A virus. Mol Biol Evol. 2008;25(9):1809-24.</code></div>',1),Le=h('<div class="fade-visualization svelte-8tjx1k"><!></div>');function Se(Y,N){se(N,!1);const i=_(),v=_();let c=Ae(N,"data",8),g=_();function A(o){var m,f;const d=o["test results"]||{};return{sequences:((m=o.input)==null?void 0:m.sequences)||0,sites:((f=o.input)==null?void 0:f.sites)||0,partitions:Object.keys(o["data partitions"]||{}).length,pValue:d["p-value"]||1,lrt:d.LRT||0,hasDirectionalBias:(d["p-value"]||1)<=.05}}function K(o){const d=o["branch attributes"]||{},m=[];return Object.entries(d).forEach(([f,b])=>{b&&b.bias&&m.push({branch:f,bias:b.bias,direction:b.bias>0?"Positive":"Negative"})}),m}function C(o){return o.length?ye({title:"Directional Selection Bias",width:800,height:300,x:{label:"Branch",type:"band"},y:{label:"Bias Score",grid:!0},color:{legend:!0},marks:[Fe([0],{stroke:"#666",strokeDasharray:"3,3"}),ke(o,{x:"branch",y:"bias",fill:"direction",title:d=>`${d.branch}
Bias: ${d.bias.toFixed(3)}
Direction: ${d.direction}`})]}):null}let U=_(!1);te(()=>{s(U,!0)});function W(){if(e(g)){const o=C(e(v));o&&(ne(g,e(g).innerHTML=""),e(g).appendChild(o))}}Q(()=>Z(c()),()=>{s(i,c()?A(c()):null)}),Q(()=>Z(c()),()=>{s(v,c()?K(c()):[])}),Q(()=>(e(U),e(v)),()=>{e(U)&&e(v).length>0&&W()}),re(),ie();var R=Le(),w=l(R);{var T=o=>{var d=Ee();u(o,d)},z=o=>{var d=je(),m=n(le(d),2);{var f=x=>{var y=Be(),B=l(y),M=l(B),O=l(M,!0);a(M),D(2),a(B);var j=n(B,2),J=l(j),X=l(J,!0);a(J),D(2),a(j);var $=n(j,2),q=l($),G=l(q,!0);a(q),D(2),a($);var V=n($,2),t=l(V),r=l(t,!0);a(t),D(2),a(V),a(y),I(p=>{E(O,(e(i),L(()=>e(i).sequences))),E(X,(e(i),L(()=>e(i).sites))),ee(q,`color: ${e(i),L(()=>e(i).hasDirectionalBias?"#e3243b":"#666")??""}`),E(G,p),ee(t,`color: ${e(i),L(()=>e(i).hasDirectionalBias?"#e3243b":"#666")??""}`),E(r,(e(i),L(()=>e(i).hasDirectionalBias?"YES":"NO")))},[()=>(e(i),L(()=>e(i).pValue.toExponential(3)))]),u(x,y)};S(m,x=>{e(i)&&x(f)})}var b=n(m,2),P=n(l(b),2);me(P,x=>s(g,x),()=>e(g)),a(b),D(2),u(o,d)};S(w,o=>{c()?o(z,!1):o(T)})}a(R),u(Y,R),ae()}var Ue=h('<meta name="description" content="Interactive visualization of FADE (FUBAR Approach to Directional Evolution) analysis results"/>'),Re=h("<option> </option>"),we=h('<div class="status loading svelte-14pglpm"><p>Loading data...</p></div>'),Te=h('<div class="status error svelte-14pglpm"><p> </p> <button class="svelte-14pglpm">Dismiss</button></div>'),ze=h('<div class="visualization-section svelte-14pglpm"><!></div>'),Pe=h('<div class="no-data svelte-14pglpm"><h3>No Data Loaded</h3> <p>Please load FADE analysis data using one of the options above to see the visualization.</p></div>'),Me=h(`<div class="fade-demo svelte-14pglpm"><div class="header svelte-14pglpm"><h1 class="svelte-14pglpm">FADE Analysis</h1> <p class="svelte-14pglpm">Interactive visualization of FUBAR Approach to Directional Evolution analysis.
      FADE tests for directional selection toward specific amino acids.</p></div> <div class="data-loading svelte-14pglpm"><h2>Load Data</h2> <div class="loading-options svelte-14pglpm"><div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Test Data</h3> <div class="test-data-controls svelte-14pglpm"><select class="svelte-14pglpm"></select> <button class="svelte-14pglpm"> </button></div> <p class="help svelte-14pglpm">Load example data to explore the visualization features.</p></div> <div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Load from URL</h3> <div class="url-input svelte-14pglpm"><input type="url" placeholder="Enter JSON file URL..." class="svelte-14pglpm"/> <button class="svelte-14pglpm">Load</button></div> <p class="help svelte-14pglpm">Load FADE results from a remote JSON file.</p></div> <div class="option svelte-14pglpm"><h3 class="svelte-14pglpm">Upload File</h3> <input type="file" accept=".json,.gz" class="svelte-14pglpm"/> <p class="help svelte-14pglpm">Upload a local FADE JSON file from your computer.</p></div></div> <!> <!></div> <!> <div class="usage-info svelte-14pglpm"><h2 class="svelte-14pglpm">About FADE</h2> <h3 class="svelte-14pglpm">What is FADE?</h3> <p><strong>FADE (FUBAR Approach to Directional Evolution)</strong> is a maximum likelihood 
      method for testing directional selection toward specific amino acids. It extends FUBAR 
      to detect directional evolutionary bias in protein sequences.</p> <h3 class="svelte-14pglpm">Key Features</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Directional bias:</strong> Tests for selection toward specific amino acids</li> <li class="svelte-14pglpm"><strong>Maximum likelihood:</strong> Uses ML framework for parameter estimation</li> <li class="svelte-14pglpm"><strong>FUBAR extension:</strong> Built on the FUBAR methodology</li> <li class="svelte-14pglpm"><strong>Branch-level analysis:</strong> Detects directional bias on specific branches</li> <li class="svelte-14pglpm"><strong>Statistical testing:</strong> Provides likelihood ratio tests for significance</li></ul> <h3 class="svelte-14pglpm">Interpretation</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Positive bias:</strong> Selection favors specific amino acid changes</li> <li class="svelte-14pglpm"><strong>Negative bias:</strong> Selection disfavors certain amino acid changes</li> <li class="svelte-14pglpm"><strong>Magnitude:</strong> Strength of directional selection pressure</li> <li class="svelte-14pglpm"><strong>p-value &lt; 0.05:</strong> Significant evidence for directional bias</li> <li class="svelte-14pglpm"><strong>Branch patterns:</strong> Reveals lineage-specific directional evolution</li></ul> <h3 class="svelte-14pglpm">Using This Component</h3> <pre class="svelte-14pglpm"><code class="svelte-14pglpm">import &#123; FadeVisualization &#125; from 'hyphy-scope';

&lt;FadeVisualization data=&#123;fadeResults&#125; /&gt;</code></pre> <h3 class="svelte-14pglpm">Data Format</h3> <p>The component expects FADE analysis results in JSON format with the following structure:</p> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><code class="svelte-14pglpm">test results</code> - Statistical test results (p-value, LRT)</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">branch attributes</code> - Branch-specific bias measurements</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">input</code> - Input parameters (sequences, sites)</li> <li class="svelte-14pglpm"><code class="svelte-14pglpm">data partitions</code> - Partition information</li></ul> <h3 class="svelte-14pglpm">Applications</h3> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>Protein evolution:</strong> Identify directional changes in protein function</li> <li class="svelte-14pglpm"><strong>Host adaptation:</strong> Detect adaptation to new host environments</li> <li class="svelte-14pglpm"><strong>Drug resistance:</strong> Understand directional changes in drug targets</li> <li class="svelte-14pglpm"><strong>Immune escape:</strong> Identify directional evolution in immune-targeted regions</li> <li class="svelte-14pglpm"><strong>Functional shifts:</strong> Detect systematic changes in protein function</li></ul> <h3 class="svelte-14pglpm">Method Comparison</h3> <p>FADE differs from other HyPhy methods:</p> <ul class="svelte-14pglpm"><li class="svelte-14pglpm"><strong>vs. FEL/MEME:</strong> Tests directional bias rather than positive selection</li> <li class="svelte-14pglpm"><strong>vs. RELAX:</strong> Detects bias toward specific changes, not intensity changes</li> <li class="svelte-14pglpm"><strong>vs. BUSTED:</strong> Branch-specific rather than gene-wide testing</li> <li class="svelte-14pglpm"><strong>Specialization:</strong> Designed specifically for directional evolution detection</li></ul></div></div>`);function Xe(Y,N){se(N,!1);let i=_(null),v=_(!1),c=_(""),g=_(""),A=_("fade");const K=[{value:"fel",label:"FEL"},{value:"meme",label:"MEME"},{value:"absrel",label:"aBSREL"},{value:"busted",label:"BUSTED"},{value:"relax",label:"RELAX"},{value:"slac",label:"SLAC"},{value:"bgm",label:"BGM"},{value:"fade",label:"FADE"}];te(async()=>{await C()});async function C(){try{s(v,!0),s(c,""),s(i,await he(e(A)))}catch(t){s(c,`Failed to load ${e(A).toUpperCase()} test data: ${t.message}`),s(i,null)}finally{s(v,!1)}}async function U(){if(!e(g).trim()){s(c,"Please enter a valid URL");return}try{s(v,!0),s(c,""),s(i,await De(e(g)))}catch(t){s(c,`Failed to load data from URL: ${t.message}`),s(i,null)}finally{s(v,!1)}}async function W(t){var p;const r=(p=t.target.files)==null?void 0:p[0];if(r)try{s(v,!0),s(c,""),s(i,await xe(r))}catch(k){s(c,`Failed to load file: ${k.message}`),s(i,null)}finally{s(v,!1)}}function R(){s(c,"")}ie();var w=Me();de(t=>{var r=Ue();ve.title="FADE Analysis - HyPhy Scope",u(t,r)});var T=n(l(w),2),z=n(l(T),2),o=l(z),d=n(l(o),2),m=l(d);I(()=>{e(A),ce(()=>{})}),ge(m,5,()=>K,be,(t,r)=>{var p=Re(),k=l(p,!0);a(p);var F={};I(()=>{E(k,e(r).label),F!==(F=e(r).value)&&(p.value=(p.__value=e(r).value)??"")}),u(t,p)}),a(m);var f=n(m,2),b=l(f,!0);a(f),a(d),D(2),a(o);var P=n(o,2),x=n(l(P),2),y=l(x);_e(y);var B=n(y,2);a(x),D(2),a(P);var M=n(P,2),O=n(l(M),2);D(2),a(M),a(z);var j=n(z,2);{var J=t=>{var r=we();u(t,r)};S(j,t=>{e(v)&&t(J)})}var X=n(j,2);{var $=t=>{var r=Te(),p=l(r),k=l(p,!0);a(p);var F=n(p,2);a(r),I(()=>E(k,e(c))),H("click",F,R),u(t,r)};S(X,t=>{e(c)&&t($)})}a(T);var q=n(T,2);{var G=t=>{var r=ze(),p=l(r);Se(p,{get data(){return e(i)}}),a(r),u(t,r)},V=t=>{var r=pe(),p=le(r);{var k=F=>{var oe=Pe();u(F,oe)};S(p,F=>{e(v)||F(k)},!0)}u(t,r)};S(q,t=>{e(i)?t(G):t(V,!1)})}D(2),a(w),I(t=>{f.disabled=e(v),E(b,e(v)?"Loading...":"Load Test Data"),y.disabled=e(v),B.disabled=t,O.disabled=e(v)},[()=>e(v)||!e(g).trim()]),ue(m,()=>e(A),t=>s(A,t)),H("click",f,C),fe(y,()=>e(g),t=>s(g,t)),H("click",B,U),H("change",O,W),u(Y,w),ae()}export{Xe as component};
