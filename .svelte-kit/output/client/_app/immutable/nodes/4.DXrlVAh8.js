import"../chunks/CWj6FrbW.js";import"../chunks/O9NtFhcF.js";import{o as ee}from"../chunks/Bm-Peyi0.js";import{p as se,o as t,q as x,z as Q,j as Z,i as e,A as oe,f as h,c as i,r as a,a as m,m as te,B as re,s as n,x as ae,n as _,t as I,e as j,$ as ne,v as ve,w as de}from"../chunks/BrBLfwSL.js";import{s as M,h as ce,e as H}from"../chunks/DZG3np5x.js";import{i as F,b as ue}from"../chunks/kkMc64k_.js";import{e as pe,b as fe,a as ge,g as me,i as he,r as xe,l as _e,c as be}from"../chunks/CdTtAD6V.js";import{i as ie}from"../chunks/i3jxjd7U.js";import{z as ye,D as we}from"../chunks/CdoYSR-b.js";import{p as Be}from"../chunks/DNC5C8Oc.js";import{b as Se}from"../chunks/z60al4It.js";var Me=h('<div class="loading svelte-295fdw">Loading BGM data...</div>'),Le=h('<div class="summary-tiles svelte-295fdw"><div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Sequences</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Sites</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw"> </div> <div class="tile-description svelte-295fdw">Tested Pairs</div></div> <div class="tile svelte-295fdw"><div class="tile-number svelte-295fdw" style="color: #e3243b"> </div> <div class="tile-description svelte-295fdw">Significant Correlations</div></div></div>'),Ce=h('<div class="analysis-info svelte-295fdw"><h2 class="svelte-295fdw">BGM Analysis Results</h2> <p><strong>Bayesian Graphical Model</strong> for detecting correlated evolution between sites.</p></div> <!> <div class="plot-section svelte-295fdw"><h3 class="svelte-295fdw">Site Correlations</h3> <div class="plot-container svelte-295fdw"></div></div> <div class="citation svelte-295fdw"><h3 class="svelte-295fdw">Citation</h3> <code class="svelte-295fdw">Poon AFY, Lewis FI, Pond SLK, Frost SDW. An evolutionary-network model reveals stratified interactions in the V3 loop of the HIV-1 envelope. PLoS Comput Biol. 2007;3(11):e231.</code></div>',1),De=h('<div class="bgm-visualization svelte-295fdw"><!></div>');function Fe(J,E){se(E,!1);const r=x(),v=x();let d=Be(E,"data",8),f=x();function B(l){var g,p;const c=l["test results"]||{};return{sequences:((g=l.input)==null?void 0:g.sequences)||0,sites:((p=l.input)==null?void 0:p.sites)||0,partitions:Object.keys(l["data partitions"]||{}).length,correlations:Object.keys(c).length,significantCorrelations:Object.values(c).filter(L=>(L["p-value"]||1)<=.05).length}}function Y(l){const c=l["test results"]||{};return Object.entries(c).map(([g,p])=>({pair:g,correlation:p.correlation||0,pValue:p["p-value"]||1,significant:(p["p-value"]||1)<=.05}))}function N(l){return l.length?ye({title:"Site-to-Site Correlations",width:800,height:400,x:{label:"Site Pair",type:"band"},y:{label:"Correlation Coefficient",grid:!0},color:{legend:!0},marks:[we([0],{stroke:"#666",strokeDasharray:"3,3"}),Se(l,{x:"pair",y:"correlation",fill:"significant",title:c=>`${c.pair}
Correlation: ${c.correlation.toFixed(3)}
p-value: ${c.pValue.toFixed(4)}`})]}):null}let G=x(!1);ee(()=>{t(G,!0)});function K(){if(e(f)){const l=N(e(v));l&&(re(f,e(f).innerHTML=""),e(f).appendChild(l))}}Q(()=>Z(d()),()=>{t(r,d()?B(d()):null)}),Q(()=>Z(d()),()=>{t(v,d()?Y(d()):[])}),Q(()=>(e(G),e(v)),()=>{e(G)&&e(v).length>0&&K()}),oe(),ie();var k=De(),P=i(k);{var U=l=>{var c=Me();m(l,c)},z=l=>{var c=Ce(),g=n(ae(c),2);{var p=b=>{var y=Le(),C=i(y),T=i(C),O=i(T,!0);a(T),_(2),a(C);var D=n(C,2),q=i(D),W=i(q,!0);a(q),_(2),a(D);var A=n(D,2),V=i(A),X=i(V,!0);a(V),_(2),a(A);var $=n(A,2),s=i($),o=i(s,!0);a(s),_(2),a($),a(y),I(()=>{M(O,(e(r),j(()=>e(r).sequences))),M(W,(e(r),j(()=>e(r).sites))),M(X,(e(r),j(()=>e(r).correlations))),M(o,(e(r),j(()=>e(r).significantCorrelations)))}),m(b,y)};F(g,b=>{e(r)&&b(p)})}var L=n(g,2),R=n(i(L),2);ue(R,b=>t(f,b),()=>e(f)),a(L),_(2),m(l,c)};F(P,l=>{d()?l(z,!1):l(U)})}a(k),m(J,k),te()}var Ge=h('<meta name="description" content="Interactive visualization of BGM (Bayesian Graphical Model) analysis results"/>'),ke=h("<option> </option>"),Pe=h('<div class="status loading svelte-2x16si"><p>Loading data...</p></div>'),Ue=h('<div class="status error svelte-2x16si"><p> </p> <button class="svelte-2x16si">Dismiss</button></div>'),ze=h('<div class="visualization-section svelte-2x16si"><!></div>'),Re=h('<div class="no-data svelte-2x16si"><h3>No Data Loaded</h3> <p>Please load BGM analysis data using one of the options above to see the visualization.</p></div>'),Te=h(`<div class="bgm-demo svelte-2x16si"><div class="header svelte-2x16si"><h1 class="svelte-2x16si">BGM Analysis</h1> <p class="svelte-2x16si">Interactive visualization of Bayesian Graphical Model analysis.
      BGM detects correlated evolution between sites using graphical models.</p></div> <div class="data-loading svelte-2x16si"><h2>Load Data</h2> <div class="loading-options svelte-2x16si"><div class="option svelte-2x16si"><h3 class="svelte-2x16si">Test Data</h3> <div class="test-data-controls svelte-2x16si"><select class="svelte-2x16si"></select> <button class="svelte-2x16si"> </button></div> <p class="help svelte-2x16si">Load example data to explore the visualization features.</p></div> <div class="option svelte-2x16si"><h3 class="svelte-2x16si">Load from URL</h3> <div class="url-input svelte-2x16si"><input type="url" placeholder="Enter JSON file URL..." class="svelte-2x16si"/> <button class="svelte-2x16si">Load</button></div> <p class="help svelte-2x16si">Load BGM results from a remote JSON file.</p></div> <div class="option svelte-2x16si"><h3 class="svelte-2x16si">Upload File</h3> <input type="file" accept=".json,.gz" class="svelte-2x16si"/> <p class="help svelte-2x16si">Upload a local BGM JSON file from your computer.</p></div></div> <!> <!></div> <!> <div class="usage-info svelte-2x16si"><h2 class="svelte-2x16si">About BGM</h2> <h3 class="svelte-2x16si">What is BGM?</h3> <p><strong>BGM (Bayesian Graphical Model)</strong> is a method for detecting correlated 
      evolution between sites in protein-coding sequences. It uses probabilistic graphical 
      models to identify pairs of sites that evolve in a coordinated manner.</p> <h3 class="svelte-2x16si">Key Features</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>Bayesian framework:</strong> Uses Bayesian inference for model selection</li> <li class="svelte-2x16si"><strong>Graphical models:</strong> Models dependencies between sites</li> <li class="svelte-2x16si"><strong>Correlation detection:</strong> Identifies correlated evolutionary patterns</li> <li class="svelte-2x16si"><strong>Network analysis:</strong> Reveals evolutionary networks between sites</li> <li class="svelte-2x16si"><strong>Statistical rigor:</strong> Provides posterior probabilities for correlations</li></ul> <h3 class="svelte-2x16si">Interpretation</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>High correlation:</strong> Sites evolve together (functional/structural constraints)</li> <li class="svelte-2x16si"><strong>Positive correlation:</strong> Similar evolutionary pressures</li> <li class="svelte-2x16si"><strong>Negative correlation:</strong> Compensatory changes</li> <li class="svelte-2x16si"><strong>p-value &lt; 0.05:</strong> Significant evidence for correlation</li> <li class="svelte-2x16si"><strong>Network structure:</strong> Reveals functional domains or interactions</li></ul> <h3 class="svelte-2x16si">Using This Component</h3> <pre class="svelte-2x16si"><code class="svelte-2x16si">import &#123; BgmVisualization &#125; from 'hyphy-scope';

&lt;BgmVisualization data=&#123;bgmResults&#125; /&gt;</code></pre> <h3 class="svelte-2x16si">Data Format</h3> <p>The component expects BGM analysis results in JSON format with the following structure:</p> <ul class="svelte-2x16si"><li class="svelte-2x16si"><code class="svelte-2x16si">test results</code> - Correlation results for site pairs</li> <li class="svelte-2x16si"><code class="svelte-2x16si">data partitions</code> - Partition information for sites</li> <li class="svelte-2x16si"><code class="svelte-2x16si">input</code> - Input parameters (sequences, sites)</li></ul> <h3 class="svelte-2x16si">Applications</h3> <ul class="svelte-2x16si"><li class="svelte-2x16si"><strong>Protein structure:</strong> Identify structurally interacting residues</li> <li class="svelte-2x16si"><strong>Functional domains:</strong> Discover co-evolving functional regions</li> <li class="svelte-2x16si"><strong>Compensatory mutations:</strong> Find sites with coordinated changes</li> <li class="svelte-2x16si"><strong>Drug resistance:</strong> Understand resistance mutation networks</li></ul></div></div>`);function Ye(J,E){se(E,!1);let r=x(null),v=x(!1),d=x(""),f=x(""),B=x("bgm");const Y=[{value:"fel",label:"FEL"},{value:"meme",label:"MEME"},{value:"absrel",label:"aBSREL"},{value:"busted",label:"BUSTED"},{value:"relax",label:"RELAX"},{value:"slac",label:"SLAC"},{value:"bgm",label:"BGM"}];ee(async()=>{await N()});async function N(){try{t(v,!0),t(d,""),t(r,await me(e(B)))}catch(s){t(d,`Failed to load ${e(B).toUpperCase()} test data: ${s.message}`),t(r,null)}finally{t(v,!1)}}async function G(){if(!e(f).trim()){t(d,"Please enter a valid URL");return}try{t(v,!0),t(d,""),t(r,await _e(e(f)))}catch(s){t(d,`Failed to load data from URL: ${s.message}`),t(r,null)}finally{t(v,!1)}}async function K(s){var u;const o=(u=s.target.files)==null?void 0:u[0];if(o)try{t(v,!0),t(d,""),t(r,await be(o))}catch(S){t(d,`Failed to load file: ${S.message}`),t(r,null)}finally{t(v,!1)}}function k(){t(d,"")}ie();var P=Te();ce(s=>{var o=Ge();ne.title="BGM Analysis - HyPhy Scope",m(s,o)});var U=n(i(P),2),z=n(i(U),2),l=i(z),c=n(i(l),2),g=i(c);I(()=>{e(B),ve(()=>{})}),pe(g,5,()=>Y,he,(s,o)=>{var u=ke(),S=i(u,!0);a(u);var w={};I(()=>{M(S,e(o).label),w!==(w=e(o).value)&&(u.value=(u.__value=e(o).value)??"")}),m(s,u)}),a(g);var p=n(g,2),L=i(p,!0);a(p),a(c),_(2),a(l);var R=n(l,2),b=n(i(R),2),y=i(b);xe(y);var C=n(y,2);a(b),_(2),a(R);var T=n(R,2),O=n(i(T),2);_(2),a(T),a(z);var D=n(z,2);{var q=s=>{var o=Pe();m(s,o)};F(D,s=>{e(v)&&s(q)})}var W=n(D,2);{var A=s=>{var o=Ue(),u=i(o),S=i(u,!0);a(u);var w=n(u,2);a(o),I(()=>M(S,e(d))),H("click",w,k),m(s,o)};F(W,s=>{e(d)&&s(A)})}a(U);var V=n(U,2);{var X=s=>{var o=ze(),u=i(o);Fe(u,{get data(){return e(r)}}),a(o),m(s,o)},$=s=>{var o=de(),u=ae(o);{var S=w=>{var le=Re();m(w,le)};F(u,w=>{e(v)||w(S)},!0)}m(s,o)};F(V,s=>{e(r)?s(X):s($,!1)})}_(2),a(P),I(s=>{p.disabled=e(v),M(L,e(v)?"Loading...":"Load Test Data"),y.disabled=e(v),C.disabled=s,O.disabled=e(v)},[()=>e(v)||!e(f).trim()]),fe(g,()=>e(B),s=>t(B,s)),H("click",p,N),ge(y,()=>e(f),s=>t(f,s)),H("click",C,G),H("change",O,K),m(J,P),te()}export{Ye as component};
